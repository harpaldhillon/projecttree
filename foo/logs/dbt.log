2020-04-07 10:55:47.018774 (MainThread): Running with dbt=0.16.0
2020-04-07 10:55:47.125976 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-04-07 10:55:47.130285 (MainThread): Tracking: tracking
2020-04-07 10:55:47.132353 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0210405dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020d9daeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020d9daf40>]}
2020-04-07 10:55:47.161618 (MainThread): Partial parsing not enabled
2020-04-07 10:55:47.163521 (MainThread): Parsing macros/core.sql
2020-04-07 10:55:47.172160 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 10:55:47.175127 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 10:55:47.177149 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 10:55:47.178867 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 10:55:47.180936 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 10:55:47.226009 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 10:55:47.234408 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 10:55:47.237306 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 10:55:47.244413 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 10:55:47.250069 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 10:55:47.257137 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 10:55:47.279492 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 10:55:47.312637 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 10:55:47.330896 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 10:55:47.333526 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 10:55:47.346848 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 10:55:47.354427 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 10:55:47.356959 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 10:55:47.359879 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 10:55:47.369896 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 10:55:47.371881 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 10:55:47.373832 (MainThread): Parsing macros/etc/query.sql
2020-04-07 10:55:47.375746 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 10:55:47.378796 (MainThread): Parsing macros/catalog.sql
2020-04-07 10:55:47.390675 (MainThread): Parsing macros/adapters.sql
2020-04-07 10:55:47.411305 (MainThread): Parsing macros/relations.sql
2020-04-07 10:55:47.412883 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 10:55:47.414588 (MainThread): Parsing macros/catalog.sql
2020-04-07 10:55:47.417729 (MainThread): Parsing macros/adapters.sql
2020-04-07 10:55:47.435473 (MainThread): Parsing macros/relations.sql
2020-04-07 10:55:47.437868 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 10:55:47.472379 (MainThread): Partial parsing not enabled
2020-04-07 10:55:47.516995 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2020-04-07 10:55:47.518096 (MainThread): Opening a new connection, currently in state init
2020-04-07 10:55:47.537975 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2020-04-07 10:55:47.538682 (MainThread): Opening a new connection, currently in state init
2020-04-07 10:55:47.590409 (MainThread): Acquiring new redshift connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 10:55:47.591455 (MainThread): Opening a new connection, currently in state init
2020-04-07 10:55:47.603317 (MainThread): Acquiring new redshift connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 10:55:47.604450 (MainThread): Opening a new connection, currently in state init
2020-04-07 10:55:47.641400 (MainThread): Acquiring new redshift connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 10:55:47.642395 (MainThread): Opening a new connection, currently in state init
2020-04-07 10:55:47.650433 (MainThread): Acquiring new redshift connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 10:55:47.651403 (MainThread): Opening a new connection, currently in state init
2020-04-07 10:55:47.868146 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 149 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 10:55:47.872099 (MainThread): 
2020-04-07 10:55:47.873214 (MainThread): Acquiring new redshift connection "master".
2020-04-07 10:55:47.873882 (MainThread): Opening a new connection, currently in state init
2020-04-07 10:55:47.898600 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_warehouse_dbt_alice".
2020-04-07 10:55:47.904454 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-04-07 10:55:48.013908 (ThreadPoolExecutor-1_0): Using redshift connection "list_warehouse_dbt_alice".
2020-04-07 10:55:48.019720 (ThreadPoolExecutor-1_0): On list_warehouse_dbt_alice: BEGIN
2020-04-07 10:55:48.020682 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2020-04-07 10:55:48.021723 (ThreadPoolExecutor-1_0): Got an error when attempting to open a postgres connection: 'could not connect to server: Connection refused
	Is the server running on host "127.0.0.1" and accepting
	TCP/IP connections on port 5439?
'
2020-04-07 10:55:48.022313 (ThreadPoolExecutor-1_0): Error running SQL: BEGIN
2020-04-07 10:55:48.022897 (ThreadPoolExecutor-1_0): Rolling back transaction.
2020-04-07 10:55:48.023516 (ThreadPoolExecutor-1_0): On list_warehouse_dbt_alice: No close available on handle
2020-04-07 10:55:48.024106 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2020-04-07 10:55:48.024645 (ThreadPoolExecutor-1_0): Rolling back transaction.
2020-04-07 10:55:48.026214 (MainThread): Connection 'master' was properly closed.
2020-04-07 10:55:48.026865 (MainThread): Connection 'list_warehouse_dbt_alice' was properly closed.
2020-04-07 10:55:48.027540 (MainThread): ERROR: Database Error
  could not connect to server: Connection refused
  	Is the server running on host "127.0.0.1" and accepting
  	TCP/IP connections on port 5439?
  
2020-04-07 10:55:48.028307 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020d861b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020d69baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020d8e8a00>]}
2020-04-07 10:55:48.029200 (MainThread): Flushing usage events
2020-04-07 11:34:43.712406 (MainThread): Running with dbt=0.16.0
2020-04-07 11:34:43.812365 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-04-07 11:34:43.818445 (MainThread): Tracking: tracking
2020-04-07 11:34:43.820698 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753e6b3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753bc82f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753bc82fa0>]}
2020-04-07 11:34:43.849802 (MainThread): Partial parsing not enabled
2020-04-07 11:34:43.851631 (MainThread): Parsing macros/core.sql
2020-04-07 11:34:43.856467 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 11:34:43.859130 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 11:34:43.860974 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 11:34:43.862743 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 11:34:43.864599 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 11:34:43.907614 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 11:34:43.916452 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 11:34:43.919223 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 11:34:43.927421 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 11:34:43.934966 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 11:34:43.943042 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 11:34:43.963926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 11:34:43.995154 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 11:34:44.012381 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 11:34:44.015374 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 11:34:44.028557 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 11:34:44.035696 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 11:34:44.038276 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 11:34:44.041048 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 11:34:44.050875 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 11:34:44.052930 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 11:34:44.054818 (MainThread): Parsing macros/etc/query.sql
2020-04-07 11:34:44.056818 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 11:34:44.060607 (MainThread): Parsing macros/catalog.sql
2020-04-07 11:34:44.073015 (MainThread): Parsing macros/adapters.sql
2020-04-07 11:34:44.093056 (MainThread): Parsing macros/relations.sql
2020-04-07 11:34:44.094635 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 11:34:44.096386 (MainThread): Parsing macros/catalog.sql
2020-04-07 11:34:44.099170 (MainThread): Parsing macros/adapters.sql
2020-04-07 11:34:44.115944 (MainThread): Parsing macros/relations.sql
2020-04-07 11:34:44.118068 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 11:34:44.154160 (MainThread): Partial parsing not enabled
2020-04-07 11:34:44.194770 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2020-04-07 11:34:44.195828 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:34:44.215018 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2020-04-07 11:34:44.215597 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:34:44.272765 (MainThread): Acquiring new redshift connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:34:44.274169 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:34:44.285858 (MainThread): Acquiring new redshift connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:34:44.286934 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:34:44.321840 (MainThread): Acquiring new redshift connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:34:44.322959 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:34:44.330810 (MainThread): Acquiring new redshift connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:34:44.332238 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:34:44.535305 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 149 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 11:34:44.539369 (MainThread): 
2020-04-07 11:34:44.540348 (MainThread): 11:34:44 | Concurrency: 1 threads (target='dev')
2020-04-07 11:34:44.541223 (MainThread): 11:34:44 | 
2020-04-07 11:34:44.559777 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2020-04-07 11:34:44.560940 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2020-04-07 11:34:44.561680 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:34:44.562475 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2020-04-07 11:34:44.577943 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2020-04-07 11:34:44.583848 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.584699 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.585735 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2020-04-07 11:34:44.586843 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2020-04-07 11:34:44.587521 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2020-04-07 11:34:44.588469 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:34:44.589049 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2020-04-07 11:34:44.596329 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2020-04-07 11:34:44.600041 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.600743 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.601485 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2020-04-07 11:34:44.601966 (Thread-1): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:34:44.602835 (Thread-1): Acquiring new redshift connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:34:44.603280 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:34:44.603845 (Thread-1): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:34:44.616724 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2020-04-07 11:34:44.620812 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.621546 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.622324 (Thread-1): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:34:44.622958 (Thread-1): Began running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:34:44.623682 (Thread-1): Acquiring new redshift connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:34:44.624163 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:34:44.624638 (Thread-1): Compiling test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:34:44.632636 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2020-04-07 11:34:44.637112 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.638269 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.639598 (Thread-1): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:34:44.640498 (Thread-1): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:34:44.641703 (Thread-1): Acquiring new redshift connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:34:44.642514 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:34:44.643239 (Thread-1): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:34:44.652056 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2020-04-07 11:34:44.656440 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.657264 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.658192 (Thread-1): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:34:44.658816 (Thread-1): Began running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:34:44.659558 (Thread-1): Acquiring new redshift connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:34:44.660347 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:34:44.660927 (Thread-1): Compiling test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:34:44.670018 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2020-04-07 11:34:44.672928 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.673790 (Thread-1): finished collecting timing info
2020-04-07 11:34:44.674758 (Thread-1): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:34:44.676593 (MainThread): Connection 'test.my_new_project.not_null_my_second_dbt_model_id' was properly closed.
2020-04-07 11:34:44.677161 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was properly closed.
2020-04-07 11:34:44.693555 (MainThread): 11:34:44 | Done.
2020-04-07 11:34:44.781564 (MainThread): Acquiring new redshift connection "generate_catalog".
2020-04-07 11:34:44.782373 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:34:44.782979 (MainThread): 11:34:44 | Building catalog
2020-04-07 11:34:44.804282 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "warehouse.information_schema".
2020-04-07 11:34:44.805532 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-04-07 11:34:44.882332 (ThreadPoolExecutor-0_0): Using redshift connection "warehouse.information_schema".
2020-04-07 11:34:44.883560 (ThreadPoolExecutor-0_0): On warehouse.information_schema: BEGIN
2020-04-07 11:34:44.884453 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2020-04-07 11:34:44.885743 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'could not connect to server: Connection refused
	Is the server running on host "127.0.0.1" and accepting
	TCP/IP connections on port 5439?
'
2020-04-07 11:34:44.886550 (ThreadPoolExecutor-0_0): Error running SQL: BEGIN
2020-04-07 11:34:44.887135 (ThreadPoolExecutor-0_0): Rolling back transaction.
2020-04-07 11:34:44.887702 (ThreadPoolExecutor-0_0): On warehouse.information_schema: No close available on handle
2020-04-07 11:34:44.888306 (ThreadPoolExecutor-0_0): Error running SQL: macro get_catalog
2020-04-07 11:34:44.888828 (ThreadPoolExecutor-0_0): Rolling back transaction.
2020-04-07 11:34:44.889744 (MainThread): Encountered an error while generating catalog: Database Error
  could not connect to server: Connection refused
  	Is the server running on host "127.0.0.1" and accepting
  	TCP/IP connections on port 5439?
  
2020-04-07 11:34:44.938586 (MainThread): dbt encountered 1 failure while writing the catalog
2020-04-07 11:34:44.939573 (MainThread): 11:34:44 | Catalog written to /root/foo/target/catalog.json
2020-04-07 11:34:44.940658 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753e6b3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753b946ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753b776250>]}
2020-04-07 11:34:44.941543 (MainThread): Flushing usage events
2020-04-07 11:34:44.947708 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2020-04-07 11:34:44.948532 (MainThread): Error sending message, disabling tracking
2020-04-07 11:34:44.949490 (MainThread): Connection 'generate_catalog' was properly closed.
2020-04-07 11:34:44.950323 (MainThread): Connection 'warehouse.information_schema' was properly closed.
2020-04-07 11:51:07.768701 (MainThread): Running with dbt=0.16.0
2020-04-07 11:51:07.831405 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-04-07 11:51:07.836863 (MainThread): Tracking: tracking
2020-04-07 11:51:07.838866 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7868c1e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f786caa9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7868bd3250>]}
2020-04-07 11:51:07.858510 (MainThread): Partial parsing not enabled
2020-04-07 11:51:07.860344 (MainThread): Parsing macros/core.sql
2020-04-07 11:51:07.865373 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 11:51:07.868063 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 11:51:07.869612 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 11:51:07.871043 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 11:51:07.872725 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 11:51:07.916244 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 11:51:07.924537 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 11:51:07.927108 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 11:51:07.934279 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 11:51:07.939942 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 11:51:07.946589 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 11:51:07.967413 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 11:51:07.999158 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 11:51:08.016009 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 11:51:08.018460 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 11:51:08.030922 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 11:51:08.038786 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 11:51:08.041238 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 11:51:08.043854 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 11:51:08.053470 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 11:51:08.055034 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 11:51:08.056626 (MainThread): Parsing macros/etc/query.sql
2020-04-07 11:51:08.058257 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 11:51:08.061073 (MainThread): Parsing macros/catalog.sql
2020-04-07 11:51:08.063994 (MainThread): Parsing macros/adapters.sql
2020-04-07 11:51:08.081513 (MainThread): Parsing macros/relations.sql
2020-04-07 11:51:08.083926 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 11:51:08.110726 (MainThread): Partial parsing not enabled
2020-04-07 11:51:08.145865 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 11:51:08.146736 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:08.165463 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 11:51:08.166018 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:08.217075 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:51:08.218120 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:08.227803 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:51:08.228602 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:08.238857 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:51:08.239655 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:08.249036 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:51:08.249986 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:08.431842 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 11:51:08.435703 (MainThread): 
2020-04-07 11:51:08.436787 (MainThread): Acquiring new postgres connection "master".
2020-04-07 11:51:08.437299 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:08.459088 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_docker_docker".
2020-04-07 11:51:08.460165 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-04-07 11:51:08.540787 (ThreadPoolExecutor-1_0): Using postgres connection "list_docker_docker".
2020-04-07 11:51:08.541946 (ThreadPoolExecutor-1_0): On list_docker_docker: BEGIN
2020-04-07 11:51:08.809476 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.27 seconds
2020-04-07 11:51:08.810849 (ThreadPoolExecutor-1_0): Using postgres connection "list_docker_docker".
2020-04-07 11:51:08.812309 (ThreadPoolExecutor-1_0): On list_docker_docker: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_docker_docker"} */
select
      'docker' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'docker'
    union all
    select
      'docker' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'docker'
  
2020-04-07 11:51:08.847197 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 11:51:08.849287 (ThreadPoolExecutor-1_0): On list_docker_docker: ROLLBACK
2020-04-07 11:51:08.922087 (MainThread): Using postgres connection "master".
2020-04-07 11:51:08.923205 (MainThread): On master: BEGIN
2020-04-07 11:51:09.185901 (MainThread): SQL status: BEGIN in 0.26 seconds
2020-04-07 11:51:09.187520 (MainThread): Using postgres connection "master".
2020-04-07 11:51:09.188696 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-04-07 11:51:09.222103 (MainThread): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 11:51:09.225354 (MainThread): On master: ROLLBACK
2020-04-07 11:51:09.266151 (MainThread): 11:51:09 | Concurrency: 1 threads (target='dev')
2020-04-07 11:51:09.267574 (MainThread): 11:51:09 | 
2020-04-07 11:51:09.272758 (Thread-1): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:51:09.273711 (Thread-1): 11:51:09 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-04-07 11:51:09.274815 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:51:09.275469 (Thread-1): Re-using an available connection from the pool (formerly list_docker_docker).
2020-04-07 11:51:09.276110 (Thread-1): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:51:09.294580 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2020-04-07 11:51:09.300458 (Thread-1): finished collecting timing info
2020-04-07 11:51:09.301329 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:51:09.301949 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: BEGIN
2020-04-07 11:51:09.393779 (Thread-1): SQL status: BEGIN in 0.09 seconds
2020-04-07 11:51:09.395164 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:51:09.396336 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_first_dbt_model_id"} */




select count(*)
from "docker"."docker"."my_first_dbt_model"
where id is null


2020-04-07 11:51:09.443684 (Thread-1): Postgres error: relation "docker.my_first_dbt_model" does not exist
LINE 7: from "docker"."docker"."my_first_dbt_model"
             ^

2020-04-07 11:51:09.445148 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: ROLLBACK
2020-04-07 11:51:09.482105 (Thread-1): finished collecting timing info
2020-04-07 11:51:09.484670 (Thread-1): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "docker.my_first_dbt_model" does not exist
  LINE 7: from "docker"."docker"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "docker.my_first_dbt_model" does not exist
LINE 7: from "docker"."docker"."my_first_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "docker.my_first_dbt_model" does not exist
  LINE 7: from "docker"."docker"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 11:51:09.489976 (Thread-1): 11:51:09 | 1 of 4 ERROR not_null_my_first_dbt_model_id.......................... [ERROR in 0.22s]
2020-04-07 11:51:09.491029 (Thread-1): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:51:09.492238 (Thread-1): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:51:09.493344 (Thread-1): 11:51:09 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-04-07 11:51:09.494418 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:51:09.495307 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_first_dbt_model_id).
2020-04-07 11:51:09.495965 (Thread-1): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:51:09.504037 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2020-04-07 11:51:09.508400 (Thread-1): finished collecting timing info
2020-04-07 11:51:09.509230 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:51:09.509724 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: BEGIN
2020-04-07 11:51:09.586693 (Thread-1): SQL status: BEGIN in 0.08 seconds
2020-04-07 11:51:09.588443 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:51:09.589636 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_second_dbt_model_id"} */




select count(*)
from "docker"."docker"."my_second_dbt_model"
where id is null


2020-04-07 11:51:09.626787 (Thread-1): Postgres error: relation "docker.my_second_dbt_model" does not exist
LINE 7: from "docker"."docker"."my_second_dbt_model"
             ^

2020-04-07 11:51:09.628619 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: ROLLBACK
2020-04-07 11:51:09.673905 (Thread-1): finished collecting timing info
2020-04-07 11:51:09.676487 (Thread-1): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "docker.my_second_dbt_model" does not exist
  LINE 7: from "docker"."docker"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "docker.my_second_dbt_model" does not exist
LINE 7: from "docker"."docker"."my_second_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "docker.my_second_dbt_model" does not exist
  LINE 7: from "docker"."docker"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 11:51:09.677982 (Thread-1): 11:51:09 | 2 of 4 ERROR not_null_my_second_dbt_model_id......................... [ERROR in 0.18s]
2020-04-07 11:51:09.679039 (Thread-1): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:51:09.680432 (Thread-1): Began running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:51:09.681279 (Thread-1): 11:51:09 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2020-04-07 11:51:09.682550 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:51:09.683193 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_second_dbt_model_id).
2020-04-07 11:51:09.683839 (Thread-1): Compiling test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:51:09.692308 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2020-04-07 11:51:09.697743 (Thread-1): finished collecting timing info
2020-04-07 11:51:09.698953 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:51:09.699507 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: BEGIN
2020-04-07 11:51:09.786720 (Thread-1): SQL status: BEGIN in 0.09 seconds
2020-04-07 11:51:09.788254 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:51:09.789569 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "docker"."docker"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 11:51:09.826889 (Thread-1): Postgres error: relation "docker.my_first_dbt_model" does not exist
LINE 12:     from "docker"."docker"."my_first_dbt_model"
                  ^

2020-04-07 11:51:09.828426 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: ROLLBACK
2020-04-07 11:51:09.866788 (Thread-1): finished collecting timing info
2020-04-07 11:51:09.869323 (Thread-1): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "docker.my_first_dbt_model" does not exist
  LINE 12:     from "docker"."docker"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "docker.my_first_dbt_model" does not exist
LINE 12:     from "docker"."docker"."my_first_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "docker.my_first_dbt_model" does not exist
  LINE 12:     from "docker"."docker"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 11:51:09.871179 (Thread-1): 11:51:09 | 3 of 4 ERROR unique_my_first_dbt_model_id............................ [ERROR in 0.19s]
2020-04-07 11:51:09.872487 (Thread-1): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:51:09.873766 (Thread-1): Began running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:51:09.874773 (Thread-1): 11:51:09 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2020-04-07 11:51:09.876047 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:51:09.876933 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.unique_my_first_dbt_model_id).
2020-04-07 11:51:09.877659 (Thread-1): Compiling test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:51:09.886366 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2020-04-07 11:51:09.891728 (Thread-1): finished collecting timing info
2020-04-07 11:51:09.892830 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:51:09.893482 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: BEGIN
2020-04-07 11:51:09.966643 (Thread-1): SQL status: BEGIN in 0.07 seconds
2020-04-07 11:51:09.967976 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:51:09.969071 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "docker"."docker"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 11:51:10.024162 (Thread-1): Postgres error: relation "docker.my_second_dbt_model" does not exist
LINE 12:     from "docker"."docker"."my_second_dbt_model"
                  ^

2020-04-07 11:51:10.026521 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: ROLLBACK
2020-04-07 11:51:10.067151 (Thread-1): finished collecting timing info
2020-04-07 11:51:10.068912 (Thread-1): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "docker.my_second_dbt_model" does not exist
  LINE 12:     from "docker"."docker"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "docker.my_second_dbt_model" does not exist
LINE 12:     from "docker"."docker"."my_second_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "docker.my_second_dbt_model" does not exist
  LINE 12:     from "docker"."docker"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 11:51:10.070384 (Thread-1): 11:51:10 | 4 of 4 ERROR unique_my_second_dbt_model_id........................... [ERROR in 0.19s]
2020-04-07 11:51:10.071415 (Thread-1): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:51:10.073831 (MainThread): 11:51:10 | 
2020-04-07 11:51:10.074670 (MainThread): 11:51:10 | Finished running 4 tests in 1.64s.
2020-04-07 11:51:10.075570 (MainThread): Connection 'master' was left open.
2020-04-07 11:51:10.076286 (MainThread): On master: Close
2020-04-07 11:51:10.077024 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was left open.
2020-04-07 11:51:10.077611 (MainThread): On test.my_new_project.unique_my_second_dbt_model_id: Close
2020-04-07 11:51:10.090482 (MainThread): 
2020-04-07 11:51:10.091262 (MainThread): Completed with 4 errors and 0 warnings:
2020-04-07 11:51:10.092133 (MainThread): 
2020-04-07 11:51:10.093158 (MainThread): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 11:51:10.094122 (MainThread):   relation "docker.my_first_dbt_model" does not exist
2020-04-07 11:51:10.095010 (MainThread):   LINE 7: from "docker"."docker"."my_first_dbt_model"
2020-04-07 11:51:10.096115 (MainThread):                ^
2020-04-07 11:51:10.097301 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 11:51:10.098320 (MainThread): 
2020-04-07 11:51:10.099151 (MainThread): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 11:51:10.100160 (MainThread):   relation "docker.my_second_dbt_model" does not exist
2020-04-07 11:51:10.101148 (MainThread):   LINE 7: from "docker"."docker"."my_second_dbt_model"
2020-04-07 11:51:10.101995 (MainThread):                ^
2020-04-07 11:51:10.102954 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 11:51:10.103710 (MainThread): 
2020-04-07 11:51:10.104495 (MainThread): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 11:51:10.105349 (MainThread):   relation "docker.my_first_dbt_model" does not exist
2020-04-07 11:51:10.106188 (MainThread):   LINE 12:     from "docker"."docker"."my_first_dbt_model"
2020-04-07 11:51:10.107003 (MainThread):                     ^
2020-04-07 11:51:10.107852 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 11:51:10.108648 (MainThread): 
2020-04-07 11:51:10.109579 (MainThread): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 11:51:10.110713 (MainThread):   relation "docker.my_second_dbt_model" does not exist
2020-04-07 11:51:10.111564 (MainThread):   LINE 12:     from "docker"."docker"."my_second_dbt_model"
2020-04-07 11:51:10.112339 (MainThread):                     ^
2020-04-07 11:51:10.113115 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 11:51:10.113875 (MainThread): 
Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
2020-04-07 11:51:10.114947 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78689598b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7868959ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7868959910>]}
2020-04-07 11:51:10.115859 (MainThread): Flushing usage events
2020-04-07 11:51:37.596007 (MainThread): Running with dbt=0.16.0
2020-04-07 11:51:37.660314 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-04-07 11:51:37.667403 (MainThread): Tracking: tracking
2020-04-07 11:51:37.669517 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c87ecfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c87dd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c87fe070>]}
2020-04-07 11:51:37.691879 (MainThread): Partial parsing not enabled
2020-04-07 11:51:37.694364 (MainThread): Parsing macros/core.sql
2020-04-07 11:51:37.699456 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 11:51:37.702192 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 11:51:37.704968 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 11:51:37.706978 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 11:51:37.709008 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 11:51:37.754111 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 11:51:37.762724 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 11:51:37.765830 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 11:51:37.772812 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 11:51:37.778672 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 11:51:37.785268 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 11:51:37.806666 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 11:51:37.840210 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 11:51:37.857635 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 11:51:37.860456 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 11:51:37.873577 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 11:51:37.880959 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 11:51:37.883438 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 11:51:37.886318 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 11:51:37.896123 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 11:51:37.898040 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 11:51:37.899899 (MainThread): Parsing macros/etc/query.sql
2020-04-07 11:51:37.901878 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 11:51:37.905007 (MainThread): Parsing macros/catalog.sql
2020-04-07 11:51:37.908025 (MainThread): Parsing macros/adapters.sql
2020-04-07 11:51:37.925635 (MainThread): Parsing macros/relations.sql
2020-04-07 11:51:37.928825 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 11:51:37.957594 (MainThread): Partial parsing not enabled
2020-04-07 11:51:37.997867 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 11:51:37.999004 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:38.019805 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 11:51:38.020578 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:38.082583 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:51:38.083804 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:38.093871 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:51:38.095127 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:38.105226 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:51:38.106523 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:38.115210 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:51:38.116207 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:38.301433 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 11:51:38.305733 (MainThread): 
2020-04-07 11:51:38.307044 (MainThread): Acquiring new postgres connection "master".
2020-04-07 11:51:38.307886 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:51:38.330490 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_postgres".
2020-04-07 11:51:38.331402 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-04-07 11:51:38.415101 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 11:51:38.416111 (ThreadPoolExecutor-1_0): On list_postgres_postgres: BEGIN
2020-04-07 11:51:38.677050 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.26 seconds
2020-04-07 11:51:38.678155 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 11:51:38.679251 (ThreadPoolExecutor-1_0): On list_postgres_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_postgres"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'postgres'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'postgres'
  
2020-04-07 11:51:38.705858 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 11:51:38.709117 (ThreadPoolExecutor-1_0): On list_postgres_postgres: ROLLBACK
2020-04-07 11:51:38.774434 (MainThread): Using postgres connection "master".
2020-04-07 11:51:38.775531 (MainThread): On master: BEGIN
2020-04-07 11:51:39.017074 (MainThread): SQL status: BEGIN in 0.24 seconds
2020-04-07 11:51:39.017951 (MainThread): Using postgres connection "master".
2020-04-07 11:51:39.018631 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-04-07 11:51:39.048811 (MainThread): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 11:51:39.051565 (MainThread): On master: ROLLBACK
2020-04-07 11:51:39.094753 (MainThread): 11:51:39 | Concurrency: 1 threads (target='dev')
2020-04-07 11:51:39.097007 (MainThread): 11:51:39 | 
2020-04-07 11:51:39.104065 (Thread-1): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:51:39.104846 (Thread-1): 11:51:39 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-04-07 11:51:39.105893 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:51:39.106489 (Thread-1): Re-using an available connection from the pool (formerly list_postgres_postgres).
2020-04-07 11:51:39.107090 (Thread-1): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:51:39.125111 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2020-04-07 11:51:39.129966 (Thread-1): finished collecting timing info
2020-04-07 11:51:39.130754 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:51:39.131262 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: BEGIN
2020-04-07 11:51:39.216567 (Thread-1): SQL status: BEGIN in 0.08 seconds
2020-04-07 11:51:39.217732 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:51:39.218506 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_first_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_first_dbt_model"
where id is null


2020-04-07 11:51:39.257872 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^

2020-04-07 11:51:39.259292 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: ROLLBACK
2020-04-07 11:51:39.302024 (Thread-1): finished collecting timing info
2020-04-07 11:51:39.304638 (Thread-1): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 11:51:39.307102 (Thread-1): 11:51:39 | 1 of 4 ERROR not_null_my_first_dbt_model_id.......................... [ERROR in 0.20s]
2020-04-07 11:51:39.308402 (Thread-1): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:51:39.309906 (Thread-1): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:51:39.311168 (Thread-1): 11:51:39 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-04-07 11:51:39.312262 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:51:39.313083 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_first_dbt_model_id).
2020-04-07 11:51:39.313746 (Thread-1): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:51:39.321934 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2020-04-07 11:51:39.327543 (Thread-1): finished collecting timing info
2020-04-07 11:51:39.328449 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:51:39.329182 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: BEGIN
2020-04-07 11:51:39.406112 (Thread-1): SQL status: BEGIN in 0.08 seconds
2020-04-07 11:51:39.408062 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:51:39.409260 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_second_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_second_dbt_model"
where id is null


2020-04-07 11:51:39.446425 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^

2020-04-07 11:51:39.448460 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: ROLLBACK
2020-04-07 11:51:39.491336 (Thread-1): finished collecting timing info
2020-04-07 11:51:39.493710 (Thread-1): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 11:51:39.495532 (Thread-1): 11:51:39 | 2 of 4 ERROR not_null_my_second_dbt_model_id......................... [ERROR in 0.18s]
2020-04-07 11:51:39.496807 (Thread-1): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:51:39.498095 (Thread-1): Began running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:51:39.499107 (Thread-1): 11:51:39 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2020-04-07 11:51:39.500233 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:51:39.500902 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_second_dbt_model_id).
2020-04-07 11:51:39.501540 (Thread-1): Compiling test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:51:39.509839 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2020-04-07 11:51:39.514618 (Thread-1): finished collecting timing info
2020-04-07 11:51:39.515489 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:51:39.516146 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: BEGIN
2020-04-07 11:51:39.598097 (Thread-1): SQL status: BEGIN in 0.08 seconds
2020-04-07 11:51:39.599286 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:51:39.600355 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 11:51:39.638373 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^

2020-04-07 11:51:39.639960 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: ROLLBACK
2020-04-07 11:51:39.678413 (Thread-1): finished collecting timing info
2020-04-07 11:51:39.680792 (Thread-1): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 11:51:39.682540 (Thread-1): 11:51:39 | 3 of 4 ERROR unique_my_first_dbt_model_id............................ [ERROR in 0.18s]
2020-04-07 11:51:39.683560 (Thread-1): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:51:39.684751 (Thread-1): Began running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:51:39.685829 (Thread-1): 11:51:39 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2020-04-07 11:51:39.686872 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:51:39.687717 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.unique_my_first_dbt_model_id).
2020-04-07 11:51:39.688480 (Thread-1): Compiling test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:51:39.697504 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2020-04-07 11:51:39.703000 (Thread-1): finished collecting timing info
2020-04-07 11:51:39.703888 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:51:39.704520 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: BEGIN
2020-04-07 11:51:39.790052 (Thread-1): SQL status: BEGIN in 0.08 seconds
2020-04-07 11:51:39.791068 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:51:39.791884 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 11:51:39.838685 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^

2020-04-07 11:51:39.840316 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: ROLLBACK
2020-04-07 11:51:39.878633 (Thread-1): finished collecting timing info
2020-04-07 11:51:39.880922 (Thread-1): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 11:51:39.882583 (Thread-1): 11:51:39 | 4 of 4 ERROR unique_my_second_dbt_model_id........................... [ERROR in 0.20s]
2020-04-07 11:51:39.883670 (Thread-1): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:51:39.886736 (MainThread): 11:51:39 | 
2020-04-07 11:51:39.888054 (MainThread): 11:51:39 | Finished running 4 tests in 1.58s.
2020-04-07 11:51:39.889243 (MainThread): Connection 'master' was left open.
2020-04-07 11:51:39.889971 (MainThread): On master: Close
2020-04-07 11:51:39.891019 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was left open.
2020-04-07 11:51:39.891762 (MainThread): On test.my_new_project.unique_my_second_dbt_model_id: Close
2020-04-07 11:51:39.904930 (MainThread): 
2020-04-07 11:51:39.906254 (MainThread): Completed with 4 errors and 0 warnings:
2020-04-07 11:51:39.908148 (MainThread): 
2020-04-07 11:51:39.909586 (MainThread): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 11:51:39.910427 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 11:51:39.911395 (MainThread):   LINE 7: from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 11:51:39.912369 (MainThread):                ^
2020-04-07 11:51:39.913847 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 11:51:39.914998 (MainThread): 
2020-04-07 11:51:39.915959 (MainThread): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 11:51:39.916977 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 11:51:39.918353 (MainThread):   LINE 7: from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 11:51:39.919567 (MainThread):                ^
2020-04-07 11:51:39.920685 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 11:51:39.921804 (MainThread): 
2020-04-07 11:51:39.922567 (MainThread): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 11:51:39.924071 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 11:51:39.925076 (MainThread):   LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 11:51:39.926077 (MainThread):                     ^
2020-04-07 11:51:39.926878 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 11:51:39.927662 (MainThread): 
2020-04-07 11:51:39.928401 (MainThread): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 11:51:39.929317 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 11:51:39.930530 (MainThread):   LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 11:51:39.931720 (MainThread):                     ^
2020-04-07 11:51:39.933129 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 11:51:39.934411 (MainThread): 
Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
2020-04-07 11:51:39.935956 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c85e8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c85e88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c85e8fd0>]}
2020-04-07 11:51:39.937709 (MainThread): Flushing usage events
2020-04-07 11:54:55.858193 (MainThread): Running with dbt=0.16.0
2020-04-07 11:54:55.918383 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-04-07 11:54:55.924854 (MainThread): Tracking: tracking
2020-04-07 11:54:55.927313 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe2b42df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe69cd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe2af81c0>]}
2020-04-07 11:54:55.947983 (MainThread): Partial parsing not enabled
2020-04-07 11:54:55.949905 (MainThread): Parsing macros/core.sql
2020-04-07 11:54:55.954822 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 11:54:55.957473 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 11:54:55.959191 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 11:54:55.960878 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 11:54:55.962782 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 11:54:56.004932 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 11:54:56.013265 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 11:54:56.015809 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 11:54:56.022932 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 11:54:56.029165 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 11:54:56.036542 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 11:54:56.058088 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 11:54:56.091548 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 11:54:56.108662 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 11:54:56.111292 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 11:54:56.124342 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 11:54:56.131522 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 11:54:56.133987 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 11:54:56.137027 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 11:54:56.146141 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 11:54:56.147884 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 11:54:56.149653 (MainThread): Parsing macros/etc/query.sql
2020-04-07 11:54:56.151450 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 11:54:56.155001 (MainThread): Parsing macros/catalog.sql
2020-04-07 11:54:56.157797 (MainThread): Parsing macros/adapters.sql
2020-04-07 11:54:56.174709 (MainThread): Parsing macros/relations.sql
2020-04-07 11:54:56.177178 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 11:54:56.204513 (MainThread): Partial parsing not enabled
2020-04-07 11:54:56.239614 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 11:54:56.240415 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:54:56.260093 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 11:54:56.260756 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:54:56.311290 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:54:56.312770 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:54:56.322173 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:54:56.323212 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:54:56.332745 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:54:56.333698 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:54:56.342407 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:54:56.363664 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:54:56.572866 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 11:54:56.576514 (MainThread): 
2020-04-07 11:54:56.577422 (MainThread): 11:54:56 | Concurrency: 1 threads (target='dev')
2020-04-07 11:54:56.578393 (MainThread): 11:54:56 | 
2020-04-07 11:54:56.582630 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2020-04-07 11:54:56.583805 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 11:54:56.584474 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:54:56.586093 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2020-04-07 11:54:56.601699 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2020-04-07 11:54:56.606402 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.607123 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.607917 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2020-04-07 11:54:56.608960 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2020-04-07 11:54:56.609616 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 11:54:56.610056 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:54:56.610550 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2020-04-07 11:54:56.617810 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2020-04-07 11:54:56.622115 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.622838 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.623840 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2020-04-07 11:54:56.624419 (Thread-1): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:54:56.625318 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:54:56.625779 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:54:56.626238 (Thread-1): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:54:56.638681 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2020-04-07 11:54:56.643726 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.644413 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.645255 (Thread-1): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:54:56.645834 (Thread-1): Began running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:54:56.646578 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:54:56.647092 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:54:56.647609 (Thread-1): Compiling test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:54:56.654926 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2020-04-07 11:54:56.660135 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.660912 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.661782 (Thread-1): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:54:56.662422 (Thread-1): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:54:56.663207 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:54:56.663725 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:54:56.664256 (Thread-1): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:54:56.673030 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2020-04-07 11:54:56.676524 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.677451 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.678319 (Thread-1): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:54:56.679029 (Thread-1): Began running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:54:56.679790 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:54:56.680308 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:54:56.680890 (Thread-1): Compiling test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:54:56.688646 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2020-04-07 11:54:56.692714 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.693490 (Thread-1): finished collecting timing info
2020-04-07 11:54:56.694408 (Thread-1): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:54:56.696118 (MainThread): Connection 'test.my_new_project.not_null_my_second_dbt_model_id' was properly closed.
2020-04-07 11:54:56.696652 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was properly closed.
2020-04-07 11:54:56.713131 (MainThread): 11:54:56 | Done.
2020-04-07 11:54:56.714017 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe286d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe281d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe28d9fd0>]}
2020-04-07 11:54:56.714870 (MainThread): Flushing usage events
2020-04-07 11:55:49.903177 (MainThread): Running with dbt=0.16.0
2020-04-07 11:55:49.963541 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-04-07 11:55:49.969351 (MainThread): Tracking: tracking
2020-04-07 11:55:49.971537 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970efbbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9712e46b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970ef70220>]}
2020-04-07 11:55:49.993347 (MainThread): Partial parsing not enabled
2020-04-07 11:55:49.995231 (MainThread): Parsing macros/core.sql
2020-04-07 11:55:50.000003 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 11:55:50.002661 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 11:55:50.004502 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 11:55:50.006447 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 11:55:50.008374 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 11:55:50.051235 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 11:55:50.059820 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 11:55:50.062686 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 11:55:50.069463 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 11:55:50.075021 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 11:55:50.081471 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 11:55:50.101961 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 11:55:50.133097 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 11:55:50.150025 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 11:55:50.152779 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 11:55:50.169549 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 11:55:50.177484 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 11:55:50.180502 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 11:55:50.183237 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 11:55:50.192541 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 11:55:50.194211 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 11:55:50.195873 (MainThread): Parsing macros/etc/query.sql
2020-04-07 11:55:50.197458 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 11:55:50.200156 (MainThread): Parsing macros/catalog.sql
2020-04-07 11:55:50.202909 (MainThread): Parsing macros/adapters.sql
2020-04-07 11:55:50.219770 (MainThread): Parsing macros/relations.sql
2020-04-07 11:55:50.222034 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 11:55:50.247906 (MainThread): Partial parsing not enabled
2020-04-07 11:55:50.285694 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 11:55:50.286568 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:50.305935 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 11:55:50.306520 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:50.357214 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:55:50.358209 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:50.368923 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:55:50.370039 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:50.379708 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:55:50.380748 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:50.388696 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:55:50.389599 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:50.570257 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 11:55:50.574198 (MainThread): 
2020-04-07 11:55:50.575339 (MainThread): 11:55:50 | Concurrency: 1 threads (target='dev')
2020-04-07 11:55:50.576411 (MainThread): 11:55:50 | 
2020-04-07 11:55:50.580677 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2020-04-07 11:55:50.581837 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 11:55:50.582477 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:55:50.583071 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2020-04-07 11:55:50.598777 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2020-04-07 11:55:50.603565 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.604329 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.605180 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2020-04-07 11:55:50.606330 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2020-04-07 11:55:50.607119 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 11:55:50.607672 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:55:50.608192 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2020-04-07 11:55:50.616149 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2020-04-07 11:55:50.620442 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.621154 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.621970 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2020-04-07 11:55:50.622620 (Thread-1): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:55:50.623457 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:55:50.623995 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:55:50.624575 (Thread-1): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:55:50.637073 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2020-04-07 11:55:50.642663 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.643430 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.644213 (Thread-1): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:55:50.644753 (Thread-1): Began running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:55:50.645472 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:55:50.645967 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:55:50.646436 (Thread-1): Compiling test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:55:50.653926 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2020-04-07 11:55:50.659215 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.659944 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.660765 (Thread-1): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:55:50.661265 (Thread-1): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:55:50.662301 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:55:50.662759 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:55:50.663235 (Thread-1): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:55:50.671636 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2020-04-07 11:55:50.676829 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.677588 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.678459 (Thread-1): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:55:50.679029 (Thread-1): Began running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:55:50.679784 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:55:50.680329 (Thread-1): Opening a new connection, currently in state init
2020-04-07 11:55:50.680876 (Thread-1): Compiling test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:55:50.688900 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2020-04-07 11:55:50.692324 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.692954 (Thread-1): finished collecting timing info
2020-04-07 11:55:50.693756 (Thread-1): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:55:50.695405 (MainThread): Connection 'test.my_new_project.not_null_my_second_dbt_model_id' was properly closed.
2020-04-07 11:55:50.696126 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was properly closed.
2020-04-07 11:55:50.712278 (MainThread): 11:55:50 | Done.
2020-04-07 11:55:50.713075 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970ed2abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970ed2ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970ed48df0>]}
2020-04-07 11:55:50.714067 (MainThread): Flushing usage events
2020-04-07 11:55:54.912840 (MainThread): Running with dbt=0.16.0
2020-04-07 11:55:54.974122 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', show=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2020-04-07 11:55:54.994266 (MainThread): Tracking: tracking
2020-04-07 11:55:54.997682 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa896af5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a980b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa896aaa250>]}
2020-04-07 11:55:55.019874 (MainThread): Partial parsing not enabled
2020-04-07 11:55:55.021942 (MainThread): Parsing macros/core.sql
2020-04-07 11:55:55.037527 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 11:55:55.043362 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 11:55:55.056160 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 11:55:55.058371 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 11:55:55.060545 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 11:55:55.104717 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 11:55:55.114354 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 11:55:55.117316 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 11:55:55.125145 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 11:55:55.134108 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 11:55:55.149271 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 11:55:55.171029 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 11:55:55.220447 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 11:55:55.237861 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 11:55:55.240622 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 11:55:55.253690 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 11:55:55.260832 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 11:55:55.263151 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 11:55:55.265874 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 11:55:55.275433 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 11:55:55.285148 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 11:55:55.300177 (MainThread): Parsing macros/etc/query.sql
2020-04-07 11:55:55.302742 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 11:55:55.306563 (MainThread): Parsing macros/catalog.sql
2020-04-07 11:55:55.309688 (MainThread): Parsing macros/adapters.sql
2020-04-07 11:55:55.327139 (MainThread): Parsing macros/relations.sql
2020-04-07 11:55:55.329387 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 11:55:55.355247 (MainThread): Partial parsing not enabled
2020-04-07 11:55:55.390069 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 11:55:55.391040 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:55.409549 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 11:55:55.410097 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:55.464653 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:55:55.465622 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:55.475580 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:55:55.476572 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:55.486573 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:55:55.487480 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:55.495573 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:55:55.496613 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:55:55.678719 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 11:55:55.681970 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-04-07 11:55:55.682812 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89688c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89688c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89688c250>]}
2020-04-07 11:55:55.683601 (MainThread): Flushing usage events
2020-04-07 11:55:56.143409 (MainThread): Connection 'test.my_new_project.not_null_my_second_dbt_model_id' was properly closed.
2020-04-07 11:56:31.177528 (MainThread): Running with dbt=0.16.0
2020-04-07 11:56:31.240319 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=True, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-04-07 11:56:31.244284 (MainThread): Tracking: tracking
2020-04-07 11:56:31.246344 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dd670dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dda58aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dd66b5160>]}
2020-04-07 11:56:31.266272 (MainThread): Partial parsing not enabled
2020-04-07 11:56:31.268255 (MainThread): Parsing macros/core.sql
2020-04-07 11:56:31.273158 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 11:56:31.275944 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 11:56:31.277807 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 11:56:31.279584 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 11:56:31.281562 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 11:56:31.324509 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 11:56:31.333200 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 11:56:31.335893 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 11:56:31.342717 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 11:56:31.348216 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 11:56:31.354909 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 11:56:31.375391 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 11:56:31.407365 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 11:56:31.424570 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 11:56:31.427593 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 11:56:31.440839 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 11:56:31.448426 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 11:56:31.451183 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 11:56:31.454084 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 11:56:31.464083 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 11:56:31.466011 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 11:56:31.467710 (MainThread): Parsing macros/etc/query.sql
2020-04-07 11:56:31.469545 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 11:56:31.472616 (MainThread): Parsing macros/catalog.sql
2020-04-07 11:56:31.475480 (MainThread): Parsing macros/adapters.sql
2020-04-07 11:56:31.492529 (MainThread): Parsing macros/relations.sql
2020-04-07 11:56:31.494880 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 11:56:31.521310 (MainThread): Partial parsing not enabled
2020-04-07 11:56:31.557734 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 11:56:31.558735 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:56:31.579821 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 11:56:31.580563 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:56:31.635490 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:56:31.636648 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:56:31.646407 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:56:31.647533 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:56:31.656812 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:56:31.657767 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:56:31.665565 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:56:31.666539 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:56:31.853238 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 11:56:31.856979 (MainThread): 
2020-04-07 11:56:31.858135 (MainThread): Acquiring new postgres connection "master".
2020-04-07 11:56:31.858736 (MainThread): Opening a new connection, currently in state init
2020-04-07 11:56:31.880960 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_postgres".
2020-04-07 11:56:31.881946 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-04-07 11:56:31.961628 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 11:56:31.962790 (ThreadPoolExecutor-1_0): On list_postgres_postgres: BEGIN
2020-04-07 11:56:32.163670 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.20 seconds
2020-04-07 11:56:32.165457 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 11:56:32.167054 (ThreadPoolExecutor-1_0): On list_postgres_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_postgres"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'postgres'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'postgres'
  
2020-04-07 11:56:32.200501 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 11:56:32.203270 (ThreadPoolExecutor-1_0): On list_postgres_postgres: ROLLBACK
2020-04-07 11:56:32.252349 (MainThread): Using postgres connection "master".
2020-04-07 11:56:32.253322 (MainThread): On master: BEGIN
2020-04-07 11:56:32.438587 (MainThread): SQL status: BEGIN in 0.18 seconds
2020-04-07 11:56:32.440090 (MainThread): Using postgres connection "master".
2020-04-07 11:56:32.441232 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-04-07 11:56:32.473667 (MainThread): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 11:56:32.476191 (MainThread): On master: ROLLBACK
2020-04-07 11:56:32.509007 (MainThread): 11:56:32 | Concurrency: 1 threads (target='dev')
2020-04-07 11:56:32.511158 (MainThread): 11:56:32 | 
2020-04-07 11:56:32.517536 (Thread-1): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:56:32.518994 (Thread-1): 11:56:32 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-04-07 11:56:32.520999 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:56:32.522132 (Thread-1): Re-using an available connection from the pool (formerly list_postgres_postgres).
2020-04-07 11:56:32.523000 (Thread-1): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:56:32.542861 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2020-04-07 11:56:32.548913 (Thread-1): finished collecting timing info
2020-04-07 11:56:32.549837 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:56:32.550416 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: BEGIN
2020-04-07 11:56:32.602557 (Thread-1): SQL status: BEGIN in 0.05 seconds
2020-04-07 11:56:32.604614 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 11:56:32.605843 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_first_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_first_dbt_model"
where id is null


2020-04-07 11:56:32.633697 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^

2020-04-07 11:56:32.635248 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: ROLLBACK
2020-04-07 11:56:32.660643 (Thread-1): finished collecting timing info
2020-04-07 11:56:32.663202 (Thread-1): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 11:56:32.665728 (Thread-1): 11:56:32 | 1 of 4 ERROR not_null_my_first_dbt_model_id.......................... [ERROR in 0.15s]
2020-04-07 11:56:32.666873 (Thread-1): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 11:56:32.668726 (Thread-1): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:56:32.670117 (Thread-1): 11:56:32 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-04-07 11:56:32.671810 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:56:32.672728 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_first_dbt_model_id).
2020-04-07 11:56:32.673457 (Thread-1): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:56:32.682016 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2020-04-07 11:56:32.686666 (Thread-1): finished collecting timing info
2020-04-07 11:56:32.687602 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:56:32.688102 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: BEGIN
2020-04-07 11:56:32.739917 (Thread-1): SQL status: BEGIN in 0.05 seconds
2020-04-07 11:56:32.741815 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 11:56:32.743268 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_second_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_second_dbt_model"
where id is null


2020-04-07 11:56:32.774110 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^

2020-04-07 11:56:32.775434 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: ROLLBACK
2020-04-07 11:56:32.804329 (Thread-1): finished collecting timing info
2020-04-07 11:56:32.806194 (Thread-1): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 11:56:32.807669 (Thread-1): 11:56:32 | 2 of 4 ERROR not_null_my_second_dbt_model_id......................... [ERROR in 0.14s]
2020-04-07 11:56:32.809110 (Thread-1): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 11:56:32.810749 (Thread-1): Began running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:56:32.812344 (Thread-1): 11:56:32 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2020-04-07 11:56:32.814487 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:56:32.815478 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_second_dbt_model_id).
2020-04-07 11:56:32.816356 (Thread-1): Compiling test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:56:32.824753 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2020-04-07 11:56:32.830507 (Thread-1): finished collecting timing info
2020-04-07 11:56:32.831652 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:56:32.832397 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: BEGIN
2020-04-07 11:56:32.877477 (Thread-1): SQL status: BEGIN in 0.04 seconds
2020-04-07 11:56:32.878976 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 11:56:32.880071 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 11:56:32.910502 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^

2020-04-07 11:56:32.911853 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: ROLLBACK
2020-04-07 11:56:32.936546 (Thread-1): finished collecting timing info
2020-04-07 11:56:32.938239 (Thread-1): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 11:56:32.939643 (Thread-1): 11:56:32 | 3 of 4 ERROR unique_my_first_dbt_model_id............................ [ERROR in 0.13s]
2020-04-07 11:56:32.940569 (Thread-1): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 11:56:32.942567 (Thread-1): Began running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:56:32.943959 (Thread-1): 11:56:32 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2020-04-07 11:56:32.945546 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:56:32.946873 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.unique_my_first_dbt_model_id).
2020-04-07 11:56:32.947747 (Thread-1): Compiling test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:56:32.957517 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2020-04-07 11:56:32.962252 (Thread-1): finished collecting timing info
2020-04-07 11:56:32.963368 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:56:32.964101 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: BEGIN
2020-04-07 11:56:33.025686 (Thread-1): SQL status: BEGIN in 0.06 seconds
2020-04-07 11:56:33.027061 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 11:56:33.028196 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 11:56:33.056715 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^

2020-04-07 11:56:33.058581 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: ROLLBACK
2020-04-07 11:56:33.084076 (Thread-1): finished collecting timing info
2020-04-07 11:56:33.086169 (Thread-1): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 11:56:33.087621 (Thread-1): 11:56:33 | 4 of 4 ERROR unique_my_second_dbt_model_id........................... [ERROR in 0.14s]
2020-04-07 11:56:33.088574 (Thread-1): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 11:56:33.092361 (MainThread): 11:56:33 | 
2020-04-07 11:56:33.093790 (MainThread): 11:56:33 | Finished running 4 tests in 1.23s.
2020-04-07 11:56:33.095307 (MainThread): Connection 'master' was left open.
2020-04-07 11:56:33.096018 (MainThread): On master: Close
2020-04-07 11:56:33.096704 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was left open.
2020-04-07 11:56:33.097549 (MainThread): On test.my_new_project.unique_my_second_dbt_model_id: Close
2020-04-07 11:56:33.109971 (MainThread): 
2020-04-07 11:56:33.111088 (MainThread): Completed with 4 errors and 0 warnings:
2020-04-07 11:56:33.112099 (MainThread): 
2020-04-07 11:56:33.112887 (MainThread): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 11:56:33.113660 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 11:56:33.114452 (MainThread):   LINE 7: from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 11:56:33.115292 (MainThread):                ^
2020-04-07 11:56:33.116156 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 11:56:33.117025 (MainThread): 
2020-04-07 11:56:33.117877 (MainThread): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 11:56:33.118777 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 11:56:33.119872 (MainThread):   LINE 7: from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 11:56:33.121193 (MainThread):                ^
2020-04-07 11:56:33.122369 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 11:56:33.123462 (MainThread): 
2020-04-07 11:56:33.124353 (MainThread): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 11:56:33.125363 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 11:56:33.126266 (MainThread):   LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 11:56:33.127320 (MainThread):                     ^
2020-04-07 11:56:33.128980 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 11:56:33.130351 (MainThread): 
2020-04-07 11:56:33.132481 (MainThread): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 11:56:33.133848 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 11:56:33.135174 (MainThread):   LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 11:56:33.136463 (MainThread):                     ^
2020-04-07 11:56:33.137716 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 11:56:33.139062 (MainThread): 
Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
2020-04-07 11:56:33.140518 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dd6521550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dd65214c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dd65210d0>]}
2020-04-07 11:56:33.141780 (MainThread): Flushing usage events
2020-04-07 12:03:01.494552 (MainThread): Running with dbt=0.16.0
2020-04-07 12:03:01.558225 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=True, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-04-07 12:03:01.561948 (MainThread): Tracking: tracking
2020-04-07 12:03:01.563973 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a45af640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a45a6220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a45c2040>]}
2020-04-07 12:03:01.586352 (MainThread): Partial parsing not enabled
2020-04-07 12:03:01.588591 (MainThread): Parsing macros/core.sql
2020-04-07 12:03:01.594686 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 12:03:01.598081 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 12:03:01.600723 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 12:03:01.602880 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 12:03:01.605121 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 12:03:01.654626 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 12:03:01.663411 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 12:03:01.666632 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 12:03:01.674005 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 12:03:01.680040 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 12:03:01.686801 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 12:03:01.707781 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 12:03:01.739100 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 12:03:01.756121 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 12:03:01.759044 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 12:03:01.772973 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 12:03:01.781440 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 12:03:01.784465 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 12:03:01.787240 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 12:03:01.796790 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 12:03:01.798575 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 12:03:01.800437 (MainThread): Parsing macros/etc/query.sql
2020-04-07 12:03:01.802267 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 12:03:01.805149 (MainThread): Parsing macros/catalog.sql
2020-04-07 12:03:01.808168 (MainThread): Parsing macros/adapters.sql
2020-04-07 12:03:01.825201 (MainThread): Parsing macros/relations.sql
2020-04-07 12:03:01.827443 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 12:03:01.862755 (MainThread): Partial parsing not enabled
2020-04-07 12:03:01.897226 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 12:03:01.898542 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:03:01.917639 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 12:03:01.918137 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:03:01.969082 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:03:01.970021 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:03:01.979686 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:03:01.980772 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:03:01.991810 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:03:01.992821 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:03:02.000671 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:03:02.001527 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:03:02.179628 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 12:03:02.183153 (MainThread): 
2020-04-07 12:03:02.184218 (MainThread): Acquiring new postgres connection "master".
2020-04-07 12:03:02.184859 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:03:02.206461 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_postgres".
2020-04-07 12:03:02.207487 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-04-07 12:03:02.286169 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 12:03:02.287318 (ThreadPoolExecutor-1_0): On list_postgres_postgres: BEGIN
2020-04-07 12:03:02.479197 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.19 seconds
2020-04-07 12:03:02.481105 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 12:03:02.482510 (ThreadPoolExecutor-1_0): On list_postgres_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_postgres"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'postgres'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'postgres'
  
2020-04-07 12:03:02.516284 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 12:03:02.519381 (ThreadPoolExecutor-1_0): On list_postgres_postgres: ROLLBACK
2020-04-07 12:03:02.580357 (MainThread): Using postgres connection "master".
2020-04-07 12:03:02.581644 (MainThread): On master: BEGIN
2020-04-07 12:03:02.754701 (MainThread): SQL status: BEGIN in 0.17 seconds
2020-04-07 12:03:02.756499 (MainThread): Using postgres connection "master".
2020-04-07 12:03:02.757730 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-04-07 12:03:02.789339 (MainThread): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 12:03:02.791664 (MainThread): On master: ROLLBACK
2020-04-07 12:03:02.818143 (MainThread): 12:03:02 | Concurrency: 1 threads (target='dev')
2020-04-07 12:03:02.819549 (MainThread): 12:03:02 | 
2020-04-07 12:03:02.824582 (Thread-1): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:03:02.825416 (Thread-1): 12:03:02 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-04-07 12:03:02.826566 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:03:02.827158 (Thread-1): Re-using an available connection from the pool (formerly list_postgres_postgres).
2020-04-07 12:03:02.827758 (Thread-1): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:03:02.844717 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2020-04-07 12:03:02.849148 (Thread-1): finished collecting timing info
2020-04-07 12:03:02.849882 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:03:02.850364 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: BEGIN
2020-04-07 12:03:02.910164 (Thread-1): SQL status: BEGIN in 0.06 seconds
2020-04-07 12:03:02.912052 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:03:02.913176 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_first_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_first_dbt_model"
where id is null


2020-04-07 12:03:02.943792 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^

2020-04-07 12:03:02.945773 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: ROLLBACK
2020-04-07 12:03:02.970469 (Thread-1): finished collecting timing info
2020-04-07 12:03:02.973032 (Thread-1): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 12:03:02.975664 (Thread-1): 12:03:02 | 1 of 4 ERROR not_null_my_first_dbt_model_id.......................... [ERROR in 0.15s]
2020-04-07 12:03:02.976688 (Thread-1): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:03:02.978060 (Thread-1): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:03:02.978949 (Thread-1): 12:03:02 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-04-07 12:03:02.980257 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:03:02.981278 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_first_dbt_model_id).
2020-04-07 12:03:02.982232 (Thread-1): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:03:02.991131 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2020-04-07 12:03:02.994652 (Thread-1): finished collecting timing info
2020-04-07 12:03:02.995344 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:03:02.995830 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: BEGIN
2020-04-07 12:03:03.049169 (Thread-1): SQL status: BEGIN in 0.05 seconds
2020-04-07 12:03:03.050939 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:03:03.052248 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_second_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_second_dbt_model"
where id is null


2020-04-07 12:03:03.077441 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^

2020-04-07 12:03:03.079446 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: ROLLBACK
2020-04-07 12:03:03.105695 (Thread-1): finished collecting timing info
2020-04-07 12:03:03.108037 (Thread-1): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 12:03:03.109695 (Thread-1): 12:03:03 | 2 of 4 ERROR not_null_my_second_dbt_model_id......................... [ERROR in 0.13s]
2020-04-07 12:03:03.110825 (Thread-1): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:03:03.112159 (Thread-1): Began running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:03:03.113476 (Thread-1): 12:03:03 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2020-04-07 12:03:03.114917 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:03:03.115741 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_second_dbt_model_id).
2020-04-07 12:03:03.116596 (Thread-1): Compiling test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:03:03.124948 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2020-04-07 12:03:03.129261 (Thread-1): finished collecting timing info
2020-04-07 12:03:03.130245 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:03:03.130974 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: BEGIN
2020-04-07 12:03:03.179461 (Thread-1): SQL status: BEGIN in 0.05 seconds
2020-04-07 12:03:03.181146 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:03:03.182628 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 12:03:03.209023 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^

2020-04-07 12:03:03.210294 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: ROLLBACK
2020-04-07 12:03:03.238039 (Thread-1): finished collecting timing info
2020-04-07 12:03:03.240346 (Thread-1): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 12:03:03.242160 (Thread-1): 12:03:03 | 3 of 4 ERROR unique_my_first_dbt_model_id............................ [ERROR in 0.13s]
2020-04-07 12:03:03.243213 (Thread-1): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:03:03.244333 (Thread-1): Began running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:03:03.245294 (Thread-1): 12:03:03 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2020-04-07 12:03:03.246466 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:03:03.247098 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.unique_my_first_dbt_model_id).
2020-04-07 12:03:03.247732 (Thread-1): Compiling test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:03:03.256343 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2020-04-07 12:03:03.261033 (Thread-1): finished collecting timing info
2020-04-07 12:03:03.261871 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:03:03.262453 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: BEGIN
2020-04-07 12:03:03.329063 (Thread-1): SQL status: BEGIN in 0.07 seconds
2020-04-07 12:03:03.330782 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:03:03.332203 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 12:03:03.356562 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^

2020-04-07 12:03:03.358534 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: ROLLBACK
2020-04-07 12:03:03.384040 (Thread-1): finished collecting timing info
2020-04-07 12:03:03.386548 (Thread-1): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 12:03:03.388135 (Thread-1): 12:03:03 | 4 of 4 ERROR unique_my_second_dbt_model_id........................... [ERROR in 0.14s]
2020-04-07 12:03:03.389860 (Thread-1): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:03:03.393479 (MainThread): 12:03:03 | 
2020-04-07 12:03:03.394398 (MainThread): 12:03:03 | Finished running 4 tests in 1.21s.
2020-04-07 12:03:03.395260 (MainThread): Connection 'master' was left open.
2020-04-07 12:03:03.396012 (MainThread): On master: Close
2020-04-07 12:03:03.396837 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was left open.
2020-04-07 12:03:03.397502 (MainThread): On test.my_new_project.unique_my_second_dbt_model_id: Close
2020-04-07 12:03:03.409855 (MainThread): 
2020-04-07 12:03:03.410459 (MainThread): Completed with 4 errors and 0 warnings:
2020-04-07 12:03:03.411237 (MainThread): 
2020-04-07 12:03:03.411920 (MainThread): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 12:03:03.412600 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 12:03:03.413386 (MainThread):   LINE 7: from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 12:03:03.414323 (MainThread):                ^
2020-04-07 12:03:03.415127 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 12:03:03.415880 (MainThread): 
2020-04-07 12:03:03.416608 (MainThread): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 12:03:03.417286 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 12:03:03.418001 (MainThread):   LINE 7: from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 12:03:03.418654 (MainThread):                ^
2020-04-07 12:03:03.419344 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 12:03:03.420089 (MainThread): 
2020-04-07 12:03:03.421105 (MainThread): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 12:03:03.421997 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 12:03:03.422956 (MainThread):   LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 12:03:03.423823 (MainThread):                     ^
2020-04-07 12:03:03.424559 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 12:03:03.425261 (MainThread): 
2020-04-07 12:03:03.426002 (MainThread): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 12:03:03.426951 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 12:03:03.427904 (MainThread):   LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 12:03:03.428771 (MainThread):                     ^
2020-04-07 12:03:03.429841 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 12:03:03.430827 (MainThread): 
Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
2020-04-07 12:03:03.431949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a43beac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a43bee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a43becd0>]}
2020-04-07 12:03:03.432817 (MainThread): Flushing usage events
2020-04-07 12:10:59.559194 (MainThread): Running with dbt=0.16.0
2020-04-07 12:10:59.619850 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=True, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-04-07 12:10:59.625522 (MainThread): Tracking: tracking
2020-04-07 12:10:59.627660 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8eb8d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c92a08a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8eb33160>]}
2020-04-07 12:10:59.647937 (MainThread): Partial parsing not enabled
2020-04-07 12:10:59.649837 (MainThread): Parsing macros/core.sql
2020-04-07 12:10:59.654599 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 12:10:59.657370 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 12:10:59.659130 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 12:10:59.660673 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 12:10:59.662522 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 12:10:59.706051 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 12:10:59.714646 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 12:10:59.717245 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 12:10:59.724180 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 12:10:59.729652 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 12:10:59.736447 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 12:10:59.758066 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 12:10:59.789846 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 12:10:59.807373 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 12:10:59.810015 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 12:10:59.823310 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 12:10:59.830287 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 12:10:59.832846 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 12:10:59.835579 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 12:10:59.844990 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 12:10:59.846894 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 12:10:59.848662 (MainThread): Parsing macros/etc/query.sql
2020-04-07 12:10:59.850372 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 12:10:59.853400 (MainThread): Parsing macros/catalog.sql
2020-04-07 12:10:59.856399 (MainThread): Parsing macros/adapters.sql
2020-04-07 12:10:59.873863 (MainThread): Parsing macros/relations.sql
2020-04-07 12:10:59.876329 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 12:10:59.904186 (MainThread): Partial parsing not enabled
2020-04-07 12:10:59.939402 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 12:10:59.940423 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:10:59.959635 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 12:10:59.960221 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:00.014560 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:11:00.015479 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:00.026545 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:11:00.027717 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:00.038324 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:11:00.039273 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:00.047868 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:11:00.048736 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:00.229861 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 12:11:00.233261 (MainThread): 
2020-04-07 12:11:00.234130 (MainThread): Acquiring new postgres connection "master".
2020-04-07 12:11:00.234769 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:00.257224 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_postgres".
2020-04-07 12:11:00.258254 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-04-07 12:11:00.336989 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 12:11:00.338192 (ThreadPoolExecutor-1_0): On list_postgres_postgres: BEGIN
2020-04-07 12:11:00.581874 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.24 seconds
2020-04-07 12:11:00.583726 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 12:11:00.585322 (ThreadPoolExecutor-1_0): On list_postgres_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_postgres"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'postgres'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'postgres'
  
2020-04-07 12:11:00.619905 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 12:11:00.623067 (ThreadPoolExecutor-1_0): On list_postgres_postgres: ROLLBACK
2020-04-07 12:11:00.694179 (MainThread): Using postgres connection "master".
2020-04-07 12:11:00.694980 (MainThread): On master: BEGIN
2020-04-07 12:11:00.866429 (MainThread): SQL status: BEGIN in 0.17 seconds
2020-04-07 12:11:00.868252 (MainThread): Using postgres connection "master".
2020-04-07 12:11:00.869407 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-04-07 12:11:00.897973 (MainThread): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 12:11:00.900678 (MainThread): On master: ROLLBACK
2020-04-07 12:11:00.926758 (MainThread): 12:11:00 | Concurrency: 1 threads (target='dev')
2020-04-07 12:11:00.928616 (MainThread): 12:11:00 | 
2020-04-07 12:11:00.934263 (Thread-1): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:11:00.935233 (Thread-1): 12:11:00 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-04-07 12:11:00.936502 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:11:00.937178 (Thread-1): Re-using an available connection from the pool (formerly list_postgres_postgres).
2020-04-07 12:11:00.937871 (Thread-1): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:11:00.954461 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2020-04-07 12:11:00.959744 (Thread-1): finished collecting timing info
2020-04-07 12:11:00.960508 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:11:00.961029 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: BEGIN
2020-04-07 12:11:01.031898 (Thread-1): SQL status: BEGIN in 0.07 seconds
2020-04-07 12:11:01.033813 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:11:01.034901 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_first_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_first_dbt_model"
where id is null


2020-04-07 12:11:01.062974 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^

2020-04-07 12:11:01.064756 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: ROLLBACK
2020-04-07 12:11:01.096361 (Thread-1): finished collecting timing info
2020-04-07 12:11:01.098897 (Thread-1): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 12:11:01.101571 (Thread-1): 12:11:01 | 1 of 4 ERROR not_null_my_first_dbt_model_id.......................... [ERROR in 0.17s]
2020-04-07 12:11:01.102695 (Thread-1): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:11:01.103813 (Thread-1): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:11:01.104806 (Thread-1): 12:11:01 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-04-07 12:11:01.106208 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:11:01.107043 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_first_dbt_model_id).
2020-04-07 12:11:01.107789 (Thread-1): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:11:01.115863 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2020-04-07 12:11:01.120492 (Thread-1): finished collecting timing info
2020-04-07 12:11:01.121265 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:11:01.121759 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: BEGIN
2020-04-07 12:11:01.181676 (Thread-1): SQL status: BEGIN in 0.06 seconds
2020-04-07 12:11:01.183304 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:11:01.184707 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_second_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_second_dbt_model"
where id is null


2020-04-07 12:11:01.212971 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^

2020-04-07 12:11:01.214661 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: ROLLBACK
2020-04-07 12:11:01.243208 (Thread-1): finished collecting timing info
2020-04-07 12:11:01.244824 (Thread-1): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 12:11:01.246100 (Thread-1): 12:11:01 | 2 of 4 ERROR not_null_my_second_dbt_model_id......................... [ERROR in 0.14s]
2020-04-07 12:11:01.247219 (Thread-1): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:11:01.248335 (Thread-1): Began running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:11:01.249429 (Thread-1): 12:11:01 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2020-04-07 12:11:01.250729 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:11:01.251397 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_second_dbt_model_id).
2020-04-07 12:11:01.252017 (Thread-1): Compiling test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:11:01.260048 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2020-04-07 12:11:01.264622 (Thread-1): finished collecting timing info
2020-04-07 12:11:01.265567 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:11:01.266252 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: BEGIN
2020-04-07 12:11:01.324480 (Thread-1): SQL status: BEGIN in 0.06 seconds
2020-04-07 12:11:01.326103 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:11:01.327507 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 12:11:01.356997 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^

2020-04-07 12:11:01.358539 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: ROLLBACK
2020-04-07 12:11:01.389312 (Thread-1): finished collecting timing info
2020-04-07 12:11:01.391617 (Thread-1): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 12:11:01.393221 (Thread-1): 12:11:01 | 3 of 4 ERROR unique_my_first_dbt_model_id............................ [ERROR in 0.14s]
2020-04-07 12:11:01.394324 (Thread-1): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:11:01.395427 (Thread-1): Began running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:11:01.396498 (Thread-1): 12:11:01 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2020-04-07 12:11:01.397803 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:11:01.398579 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.unique_my_first_dbt_model_id).
2020-04-07 12:11:01.399319 (Thread-1): Compiling test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:11:01.408639 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2020-04-07 12:11:01.413402 (Thread-1): finished collecting timing info
2020-04-07 12:11:01.414256 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:11:01.414956 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: BEGIN
2020-04-07 12:11:01.474640 (Thread-1): SQL status: BEGIN in 0.06 seconds
2020-04-07 12:11:01.476247 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:11:01.477610 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 12:11:01.509409 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^

2020-04-07 12:11:01.511154 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: ROLLBACK
2020-04-07 12:11:01.540125 (Thread-1): finished collecting timing info
2020-04-07 12:11:01.542207 (Thread-1): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 12:11:01.543472 (Thread-1): 12:11:01 | 4 of 4 ERROR unique_my_second_dbt_model_id........................... [ERROR in 0.15s]
2020-04-07 12:11:01.544252 (Thread-1): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:11:01.546537 (MainThread): 12:11:01 | 
2020-04-07 12:11:01.547200 (MainThread): 12:11:01 | Finished running 4 tests in 1.31s.
2020-04-07 12:11:01.547959 (MainThread): Connection 'master' was left open.
2020-04-07 12:11:01.548946 (MainThread): On master: Close
2020-04-07 12:11:01.549703 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was left open.
2020-04-07 12:11:01.550363 (MainThread): On test.my_new_project.unique_my_second_dbt_model_id: Close
2020-04-07 12:11:01.562757 (MainThread): 
2020-04-07 12:11:01.563501 (MainThread): Completed with 4 errors and 0 warnings:
2020-04-07 12:11:01.564397 (MainThread): 
2020-04-07 12:11:01.565203 (MainThread): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 12:11:01.566293 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 12:11:01.567276 (MainThread):   LINE 7: from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 12:11:01.568362 (MainThread):                ^
2020-04-07 12:11:01.569277 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 12:11:01.570225 (MainThread): 
2020-04-07 12:11:01.571149 (MainThread): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 12:11:01.571801 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 12:11:01.572593 (MainThread):   LINE 7: from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 12:11:01.573345 (MainThread):                ^
2020-04-07 12:11:01.574054 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 12:11:01.575059 (MainThread): 
2020-04-07 12:11:01.575768 (MainThread): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 12:11:01.576557 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 12:11:01.577460 (MainThread):   LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 12:11:01.578108 (MainThread):                     ^
2020-04-07 12:11:01.578763 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 12:11:01.579446 (MainThread): 
2020-04-07 12:11:01.580136 (MainThread): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 12:11:01.580944 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 12:11:01.581722 (MainThread):   LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 12:11:01.582519 (MainThread):                     ^
2020-04-07 12:11:01.583588 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 12:11:01.584671 (MainThread): 
Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
2020-04-07 12:11:01.585890 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8e9a2c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8e9a2220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8e9a28b0>]}
2020-04-07 12:11:01.586793 (MainThread): Flushing usage events
2020-04-07 12:11:28.492763 (MainThread): Running with dbt=0.16.0
2020-04-07 12:11:28.554478 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=True, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-04-07 12:11:28.558684 (MainThread): Tracking: tracking
2020-04-07 12:11:28.560661 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7329ec5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7368e1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732a0c130>]}
2020-04-07 12:11:28.580358 (MainThread): Partial parsing not enabled
2020-04-07 12:11:28.582469 (MainThread): Parsing macros/core.sql
2020-04-07 12:11:28.587091 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 12:11:28.590341 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 12:11:28.592747 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 12:11:28.594735 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 12:11:28.597019 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 12:11:28.639477 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 12:11:28.648100 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 12:11:28.650681 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 12:11:28.657423 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 12:11:28.662788 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 12:11:28.669320 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 12:11:28.690214 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 12:11:28.721879 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 12:11:28.738780 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 12:11:28.741436 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 12:11:28.754161 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 12:11:28.761456 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 12:11:28.764063 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 12:11:28.766821 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 12:11:28.776401 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 12:11:28.778467 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 12:11:28.780400 (MainThread): Parsing macros/etc/query.sql
2020-04-07 12:11:28.782222 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 12:11:28.785621 (MainThread): Parsing macros/catalog.sql
2020-04-07 12:11:28.788787 (MainThread): Parsing macros/adapters.sql
2020-04-07 12:11:28.806541 (MainThread): Parsing macros/relations.sql
2020-04-07 12:11:28.809161 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 12:11:28.837055 (MainThread): Partial parsing not enabled
2020-04-07 12:11:28.874245 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 12:11:28.875377 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:28.894522 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 12:11:28.895227 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:28.946429 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:11:28.947465 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:28.958312 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:11:28.959437 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:28.969283 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:11:28.970117 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:28.977955 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:11:28.978757 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:29.165720 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 12:11:29.169402 (MainThread): 
2020-04-07 12:11:29.170552 (MainThread): Acquiring new postgres connection "master".
2020-04-07 12:11:29.171120 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:11:29.192327 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_postgres".
2020-04-07 12:11:29.193325 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-04-07 12:11:29.274908 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 12:11:29.276349 (ThreadPoolExecutor-1_0): On list_postgres_postgres: BEGIN
2020-04-07 12:11:29.558937 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.28 seconds
2020-04-07 12:11:29.560110 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 12:11:29.560959 (ThreadPoolExecutor-1_0): On list_postgres_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_postgres"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'postgres'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'postgres'
  
2020-04-07 12:11:29.594226 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 12:11:29.597376 (ThreadPoolExecutor-1_0): On list_postgres_postgres: ROLLBACK
2020-04-07 12:11:29.651309 (MainThread): Using postgres connection "master".
2020-04-07 12:11:29.652533 (MainThread): On master: BEGIN
2020-04-07 12:11:29.860145 (MainThread): SQL status: BEGIN in 0.21 seconds
2020-04-07 12:11:29.861594 (MainThread): Using postgres connection "master".
2020-04-07 12:11:29.862546 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-04-07 12:11:29.899518 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2020-04-07 12:11:29.901947 (MainThread): On master: ROLLBACK
2020-04-07 12:11:29.931944 (MainThread): 12:11:29 | Concurrency: 1 threads (target='dev')
2020-04-07 12:11:29.933951 (MainThread): 12:11:29 | 
2020-04-07 12:11:29.939919 (Thread-1): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:11:29.941022 (Thread-1): 12:11:29 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-04-07 12:11:29.942298 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:11:29.943029 (Thread-1): Re-using an available connection from the pool (formerly list_postgres_postgres).
2020-04-07 12:11:29.943813 (Thread-1): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:11:29.961610 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2020-04-07 12:11:29.965531 (Thread-1): finished collecting timing info
2020-04-07 12:11:29.966417 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:11:29.967222 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: BEGIN
2020-04-07 12:11:30.025943 (Thread-1): SQL status: BEGIN in 0.06 seconds
2020-04-07 12:11:30.027867 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:11:30.029079 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_first_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_first_dbt_model"
where id is null


2020-04-07 12:11:30.063782 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^

2020-04-07 12:11:30.065439 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: ROLLBACK
2020-04-07 12:11:30.095159 (Thread-1): finished collecting timing info
2020-04-07 12:11:30.097782 (Thread-1): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 12:11:30.100035 (Thread-1): 12:11:30 | 1 of 4 ERROR not_null_my_first_dbt_model_id.......................... [ERROR in 0.16s]
2020-04-07 12:11:30.101362 (Thread-1): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:11:30.102666 (Thread-1): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:11:30.103566 (Thread-1): 12:11:30 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-04-07 12:11:30.104801 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:11:30.105625 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_first_dbt_model_id).
2020-04-07 12:11:30.106266 (Thread-1): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:11:30.114519 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2020-04-07 12:11:30.119498 (Thread-1): finished collecting timing info
2020-04-07 12:11:30.120330 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:11:30.120853 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: BEGIN
2020-04-07 12:11:30.181815 (Thread-1): SQL status: BEGIN in 0.06 seconds
2020-04-07 12:11:30.183730 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:11:30.185084 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_second_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_second_dbt_model"
where id is null


2020-04-07 12:11:30.213590 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^

2020-04-07 12:11:30.215414 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: ROLLBACK
2020-04-07 12:11:30.249859 (Thread-1): finished collecting timing info
2020-04-07 12:11:30.251798 (Thread-1): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 12:11:30.253266 (Thread-1): 12:11:30 | 2 of 4 ERROR not_null_my_second_dbt_model_id......................... [ERROR in 0.15s]
2020-04-07 12:11:30.254356 (Thread-1): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:11:30.255532 (Thread-1): Began running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:11:30.256413 (Thread-1): 12:11:30 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2020-04-07 12:11:30.257831 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:11:30.258634 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_second_dbt_model_id).
2020-04-07 12:11:30.259427 (Thread-1): Compiling test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:11:30.268005 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2020-04-07 12:11:30.272666 (Thread-1): finished collecting timing info
2020-04-07 12:11:30.273372 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:11:30.274017 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: BEGIN
2020-04-07 12:11:30.342525 (Thread-1): SQL status: BEGIN in 0.07 seconds
2020-04-07 12:11:30.344512 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:11:30.345792 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 12:11:30.378333 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^

2020-04-07 12:11:30.379672 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: ROLLBACK
2020-04-07 12:11:30.417524 (Thread-1): finished collecting timing info
2020-04-07 12:11:30.420136 (Thread-1): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 12:11:30.421737 (Thread-1): 12:11:30 | 3 of 4 ERROR unique_my_first_dbt_model_id............................ [ERROR in 0.16s]
2020-04-07 12:11:30.422901 (Thread-1): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:11:30.424102 (Thread-1): Began running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:11:30.425248 (Thread-1): 12:11:30 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2020-04-07 12:11:30.426571 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:11:30.427832 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.unique_my_first_dbt_model_id).
2020-04-07 12:11:30.428804 (Thread-1): Compiling test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:11:30.437545 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2020-04-07 12:11:30.443589 (Thread-1): finished collecting timing info
2020-04-07 12:11:30.444758 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:11:30.445676 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: BEGIN
2020-04-07 12:11:30.581120 (Thread-1): SQL status: BEGIN in 0.13 seconds
2020-04-07 12:11:30.582498 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:11:30.583498 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 12:11:30.615208 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^

2020-04-07 12:11:30.617062 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: ROLLBACK
2020-04-07 12:11:30.646963 (Thread-1): finished collecting timing info
2020-04-07 12:11:30.649159 (Thread-1): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 12:11:30.650954 (Thread-1): 12:11:30 | 4 of 4 ERROR unique_my_second_dbt_model_id........................... [ERROR in 0.22s]
2020-04-07 12:11:30.652268 (Thread-1): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:11:30.655190 (MainThread): 12:11:30 | 
2020-04-07 12:11:30.656065 (MainThread): 12:11:30 | Finished running 4 tests in 1.48s.
2020-04-07 12:11:30.656874 (MainThread): Connection 'master' was left open.
2020-04-07 12:11:30.657813 (MainThread): On master: Close
2020-04-07 12:11:30.658674 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was left open.
2020-04-07 12:11:30.659386 (MainThread): On test.my_new_project.unique_my_second_dbt_model_id: Close
2020-04-07 12:11:30.671255 (MainThread): 
2020-04-07 12:11:30.673713 (MainThread): Completed with 4 errors and 0 warnings:
2020-04-07 12:11:30.674776 (MainThread): 
2020-04-07 12:11:30.675778 (MainThread): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 12:11:30.676716 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 12:11:30.677409 (MainThread):   LINE 7: from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 12:11:30.678100 (MainThread):                ^
2020-04-07 12:11:30.678855 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 12:11:30.679683 (MainThread): 
2020-04-07 12:11:30.680878 (MainThread): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 12:11:30.681802 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 12:11:30.682728 (MainThread):   LINE 7: from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 12:11:30.683658 (MainThread):                ^
2020-04-07 12:11:30.684538 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 12:11:30.685748 (MainThread): 
2020-04-07 12:11:30.686442 (MainThread): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 12:11:30.687133 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 12:11:30.687814 (MainThread):   LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 12:11:30.688466 (MainThread):                     ^
2020-04-07 12:11:30.689105 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 12:11:30.689740 (MainThread): 
2020-04-07 12:11:30.690435 (MainThread): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 12:11:30.691098 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 12:11:30.691810 (MainThread):   LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 12:11:30.692656 (MainThread):                     ^
2020-04-07 12:11:30.693441 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 12:11:30.694291 (MainThread): 
Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
2020-04-07 12:11:30.695220 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73276aac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732788d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732788d00>]}
2020-04-07 12:11:30.695970 (MainThread): Flushing usage events
2020-04-07 12:14:16.278149 (MainThread): Running with dbt=0.16.0
2020-04-07 12:14:16.342249 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=True, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-04-07 12:14:16.346239 (MainThread): Tracking: tracking
2020-04-07 12:14:16.348161 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64a1682a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64a5516160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64a16282b0>]}
2020-04-07 12:14:16.369048 (MainThread): Partial parsing not enabled
2020-04-07 12:14:16.370883 (MainThread): Parsing macros/core.sql
2020-04-07 12:14:16.375720 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-04-07 12:14:16.378405 (MainThread): Parsing macros/schema_tests/unique.sql
2020-04-07 12:14:16.380235 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-04-07 12:14:16.381785 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-04-07 12:14:16.383684 (MainThread): Parsing macros/adapters/common.sql
2020-04-07 12:14:16.429220 (MainThread): Parsing macros/materializations/helpers.sql
2020-04-07 12:14:16.439377 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-04-07 12:14:16.442152 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-04-07 12:14:16.448975 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-04-07 12:14:16.454421 (MainThread): Parsing macros/materializations/view/view.sql
2020-04-07 12:14:16.461131 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-04-07 12:14:16.482204 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-04-07 12:14:16.514956 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-04-07 12:14:16.532481 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-04-07 12:14:16.535438 (MainThread): Parsing macros/materializations/common/merge.sql
2020-04-07 12:14:16.548755 (MainThread): Parsing macros/materializations/table/table.sql
2020-04-07 12:14:16.556094 (MainThread): Parsing macros/etc/is_incremental.sql
2020-04-07 12:14:16.558494 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-04-07 12:14:16.561160 (MainThread): Parsing macros/etc/datetime.sql
2020-04-07 12:14:16.570778 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-04-07 12:14:16.572648 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-04-07 12:14:16.574731 (MainThread): Parsing macros/etc/query.sql
2020-04-07 12:14:16.577257 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-04-07 12:14:16.580384 (MainThread): Parsing macros/catalog.sql
2020-04-07 12:14:16.583281 (MainThread): Parsing macros/adapters.sql
2020-04-07 12:14:16.600875 (MainThread): Parsing macros/relations.sql
2020-04-07 12:14:16.603138 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-04-07 12:14:16.629326 (MainThread): Partial parsing not enabled
2020-04-07 12:14:16.664567 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2020-04-07 12:14:16.665705 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:14:16.685907 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2020-04-07 12:14:16.686483 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:14:16.739902 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:14:16.740920 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:14:16.751064 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:14:16.752063 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:14:16.761274 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:14:16.762240 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:14:16.770335 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:14:16.771177 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:14:16.954071 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-04-07 12:14:16.960062 (MainThread): 
2020-04-07 12:14:16.961290 (MainThread): Acquiring new postgres connection "master".
2020-04-07 12:14:16.961887 (MainThread): Opening a new connection, currently in state init
2020-04-07 12:14:16.983849 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_postgres".
2020-04-07 12:14:16.984936 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-04-07 12:14:17.063407 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 12:14:17.064584 (ThreadPoolExecutor-1_0): On list_postgres_postgres: BEGIN
2020-04-07 12:14:17.259254 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.19 seconds
2020-04-07 12:14:17.260963 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_postgres".
2020-04-07 12:14:17.262219 (ThreadPoolExecutor-1_0): On list_postgres_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_postgres"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'postgres'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'postgres'
  
2020-04-07 12:14:17.296989 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.03 seconds
2020-04-07 12:14:17.300330 (ThreadPoolExecutor-1_0): On list_postgres_postgres: ROLLBACK
2020-04-07 12:14:17.353052 (MainThread): Using postgres connection "master".
2020-04-07 12:14:17.354226 (MainThread): On master: BEGIN
2020-04-07 12:14:17.550693 (MainThread): SQL status: BEGIN in 0.20 seconds
2020-04-07 12:14:17.552100 (MainThread): Using postgres connection "master".
2020-04-07 12:14:17.553296 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-04-07 12:14:17.589967 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2020-04-07 12:14:17.592497 (MainThread): On master: ROLLBACK
2020-04-07 12:14:17.621999 (MainThread): 12:14:17 | Concurrency: 1 threads (target='dev')
2020-04-07 12:14:17.623489 (MainThread): 12:14:17 | 
2020-04-07 12:14:17.630551 (Thread-1): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:14:17.631574 (Thread-1): 12:14:17 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-04-07 12:14:17.632775 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:14:17.633576 (Thread-1): Re-using an available connection from the pool (formerly list_postgres_postgres).
2020-04-07 12:14:17.634275 (Thread-1): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:14:17.650431 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2020-04-07 12:14:17.655014 (Thread-1): finished collecting timing info
2020-04-07 12:14:17.655768 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:14:17.656210 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: BEGIN
2020-04-07 12:14:17.708191 (Thread-1): SQL status: BEGIN in 0.05 seconds
2020-04-07 12:14:17.709957 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2020-04-07 12:14:17.711366 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_first_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_first_dbt_model"
where id is null


2020-04-07 12:14:17.740904 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^

2020-04-07 12:14:17.742197 (Thread-1): On test.my_new_project.not_null_my_first_dbt_model_id: ROLLBACK
2020-04-07 12:14:17.776173 (Thread-1): finished collecting timing info
2020-04-07 12:14:17.778725 (Thread-1): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_first_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_first_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 12:14:17.781076 (Thread-1): 12:14:17 | 1 of 4 ERROR not_null_my_first_dbt_model_id.......................... [ERROR in 0.15s]
2020-04-07 12:14:17.782263 (Thread-1): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2020-04-07 12:14:17.783943 (Thread-1): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:14:17.785115 (Thread-1): 12:14:17 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-04-07 12:14:17.786270 (Thread-1): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:14:17.787077 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_first_dbt_model_id).
2020-04-07 12:14:17.787904 (Thread-1): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:14:17.795883 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2020-04-07 12:14:17.799738 (Thread-1): finished collecting timing info
2020-04-07 12:14:17.800543 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:14:17.801029 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: BEGIN
2020-04-07 12:14:17.857629 (Thread-1): SQL status: BEGIN in 0.06 seconds
2020-04-07 12:14:17.859344 (Thread-1): Using postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2020-04-07 12:14:17.860642 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_my_second_dbt_model_id"} */




select count(*)
from "postgres"."postgres"."my_second_dbt_model"
where id is null


2020-04-07 12:14:17.888918 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^

2020-04-07 12:14:17.890428 (Thread-1): On test.my_new_project.not_null_my_second_dbt_model_id: ROLLBACK
2020-04-07 12:14:17.921121 (Thread-1): finished collecting timing info
2020-04-07 12:14:17.923079 (Thread-1): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 7: from "postgres"."postgres"."my_second_dbt_model"
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 7: from "postgres"."postgres"."my_second_dbt_model"
               ^
  compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 12:14:17.924715 (Thread-1): 12:14:17 | 2 of 4 ERROR not_null_my_second_dbt_model_id......................... [ERROR in 0.14s]
2020-04-07 12:14:17.926085 (Thread-1): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2020-04-07 12:14:17.927538 (Thread-1): Began running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:14:17.929129 (Thread-1): 12:14:17 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2020-04-07 12:14:17.930565 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:14:17.931448 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.not_null_my_second_dbt_model_id).
2020-04-07 12:14:17.932183 (Thread-1): Compiling test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:14:17.940845 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2020-04-07 12:14:17.946603 (Thread-1): finished collecting timing info
2020-04-07 12:14:17.947676 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:14:17.948552 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: BEGIN
2020-04-07 12:14:17.998277 (Thread-1): SQL status: BEGIN in 0.05 seconds
2020-04-07 12:14:17.999392 (Thread-1): Using postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2020-04-07 12:14:18.000291 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 12:14:18.027006 (Thread-1): Postgres error: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^

2020-04-07 12:14:18.028644 (Thread-1): On test.my_new_project.unique_my_first_dbt_model_id: ROLLBACK
2020-04-07 12:14:18.056001 (Thread-1): finished collecting timing info
2020-04-07 12:14:18.058609 (Thread-1): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_first_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_first_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 12:14:18.060323 (Thread-1): 12:14:18 | 3 of 4 ERROR unique_my_first_dbt_model_id............................ [ERROR in 0.13s]
2020-04-07 12:14:18.061547 (Thread-1): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2020-04-07 12:14:18.062960 (Thread-1): Began running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:14:18.064077 (Thread-1): 12:14:18 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2020-04-07 12:14:18.066097 (Thread-1): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:14:18.067345 (Thread-1): Re-using an available connection from the pool (formerly test.my_new_project.unique_my_first_dbt_model_id).
2020-04-07 12:14:18.068141 (Thread-1): Compiling test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:14:18.077840 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2020-04-07 12:14:18.082532 (Thread-1): finished collecting timing info
2020-04-07 12:14:18.083637 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:14:18.084558 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: BEGIN
2020-04-07 12:14:18.142412 (Thread-1): SQL status: BEGIN in 0.06 seconds
2020-04-07 12:14:18.143653 (Thread-1): Using postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2020-04-07 12:14:18.144566 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "postgres"."postgres"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-04-07 12:14:18.171858 (Thread-1): Postgres error: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^

2020-04-07 12:14:18.173239 (Thread-1): On test.my_new_project.unique_my_second_dbt_model_id: ROLLBACK
2020-04-07 12:14:18.198115 (Thread-1): finished collecting timing info
2020-04-07 12:14:18.199904 (Thread-1): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres.my_second_dbt_model" does not exist
LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 577, in execute
    failed_rows = self.execute_test(test)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 558, in execute_test
    res, table = self.adapter.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 217, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "postgres.my_second_dbt_model" does not exist
  LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
                    ^
  compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 12:14:18.201217 (Thread-1): 12:14:18 | 4 of 4 ERROR unique_my_second_dbt_model_id........................... [ERROR in 0.14s]
2020-04-07 12:14:18.202110 (Thread-1): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2020-04-07 12:14:18.205004 (MainThread): 12:14:18 | 
2020-04-07 12:14:18.205736 (MainThread): 12:14:18 | Finished running 4 tests in 1.24s.
2020-04-07 12:14:18.206343 (MainThread): Connection 'master' was left open.
2020-04-07 12:14:18.206924 (MainThread): On master: Close
2020-04-07 12:14:18.207544 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was left open.
2020-04-07 12:14:18.208420 (MainThread): On test.my_new_project.unique_my_second_dbt_model_id: Close
2020-04-07 12:14:18.220260 (MainThread): 
2020-04-07 12:14:18.221007 (MainThread): Completed with 4 errors and 0 warnings:
2020-04-07 12:14:18.221650 (MainThread): 
2020-04-07 12:14:18.222597 (MainThread): Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 12:14:18.223524 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 12:14:18.224613 (MainThread):   LINE 7: from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 12:14:18.225937 (MainThread):                ^
2020-04-07 12:14:18.226787 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_first_dbt_model_id.sql
2020-04-07 12:14:18.227646 (MainThread): 
2020-04-07 12:14:18.228420 (MainThread): Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 12:14:18.229102 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 12:14:18.229804 (MainThread):   LINE 7: from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 12:14:18.230491 (MainThread):                ^
2020-04-07 12:14:18.231314 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/not_null_my_second_dbt_model_id.sql
2020-04-07 12:14:18.232054 (MainThread): 
2020-04-07 12:14:18.232730 (MainThread): Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
2020-04-07 12:14:18.233485 (MainThread):   relation "postgres.my_first_dbt_model" does not exist
2020-04-07 12:14:18.234350 (MainThread):   LINE 12:     from "postgres"."postgres"."my_first_dbt_model"
2020-04-07 12:14:18.235173 (MainThread):                     ^
2020-04-07 12:14:18.235934 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_first_dbt_model_id.sql
2020-04-07 12:14:18.236662 (MainThread): 
2020-04-07 12:14:18.237833 (MainThread): Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
2020-04-07 12:14:18.238755 (MainThread):   relation "postgres.my_second_dbt_model" does not exist
2020-04-07 12:14:18.239592 (MainThread):   LINE 12:     from "postgres"."postgres"."my_second_dbt_model"
2020-04-07 12:14:18.240263 (MainThread):                     ^
2020-04-07 12:14:18.241000 (MainThread):   compiled SQL at target/compiled/my_new_project/schema_test/unique_my_second_dbt_model_id.sql
2020-04-07 12:14:18.242218 (MainThread): 
Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
2020-04-07 12:14:18.243507 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64a1385970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64a14685b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64a1468e50>]}
2020-04-07 12:14:18.244352 (MainThread): Flushing usage events
